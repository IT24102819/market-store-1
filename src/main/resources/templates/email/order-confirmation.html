<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
  <title>Order Confirmation</title>
  <style>
    body { font-family: Arial, sans-serif; line-height: 1.6; color: #333; }
    .container { max-width: 600px; margin: 0 auto; padding: 20px; }
    .header { background-color: #d4edda; padding: 10px; text-align: center; }
    .content { padding: 20px; }
    .footer { font-size: 0.9em; color: #777; text-align: center; }
    .item-table { width: 100%; border-collapse: collapse; margin: 10px 0; }
    .item-table th, .item-table td { border: 1px solid #ddd; padding: 8px; text-align: left; }
    .item-table th { background-color: #f8f9fa; }
  </style>
</head>
<body>
<div class="container">
  <div class="header">
    <h2>Order Confirmation - Lanka Fresh Mart</h2>
  </div>
  <div class="content">
    <p>Dear Customer,</p>
    <p>Thank you for your order! Below are the details:</p>
    <p><strong>Order ID:</strong> <span th:text="${orderId} ?: 'N/A'"></span></p>
    <p><strong>Order Date:</strong> <span th:text="${#dates.format(orderDate, 'yyyy-MM-dd HH:mm')} ?: 'N/A'"></span></p>
    <p><strong>Total Amount:</strong> LKR <span th:text="${#numbers.formatDecimal(totalAmount, 0.0, 2, 2)}"></span></p>
    <table class="item-table">
      <thead>
      <tr>
        <th>Product</th>
        <th>Quantity</th>
        <th>Price</th>
        <th>Subtotal</th>
      </tr>
      </thead>
      <tbody>
      <tr th:each="item : ${orderItems}">
        <td th:text="${item.product?.name} ?: 'N/A'"></td>
        <td th:text="${item.quantity} ?: 0"></td>
        <td th:text="${#numbers.formatDecimal(item.price, 2, 2)}"></td>
        <td th:text="${#numbers.formatDecimal((item.quantity ?: 0) * (item.price ?: 0.0), 2, 2)}"></td>
      </tr>
      </tbody>
    </table>
    <p>View your order status: <a th:href="${baseUrl} + '/orders/' + ${orderId}" href="${baseUrl} + '/orders/' + ${orderId} ?: '#'">Track Order</a></p>
  </div>
  <div class="footer">
    <p>This is an automated message from Lanka Fresh Mart. For support, contact admin@lankafreshmart.com.</p>
  </div>
</div>
</body>
</html>